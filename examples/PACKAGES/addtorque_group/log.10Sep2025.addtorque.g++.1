LAMMPS (10 Sep 2025 - Development - patch_5May2020-24908-gd4c3ee3c41-modified)

units           lj
lattice         fcc 0.8442
Lattice spacing in x,y,z = 1.6795962 1.6795962 1.6795962
boundary        f f f

region          ball   sphere   0.0 0.0 0.0 5.0
region          box    block  -10 10 -10 10 -10 10
region          half   block  -10  0 -10 10 -10 10

# add molecule ids so we can use chunk/atom
fix             0   all property/atom mol ghost yes

create_box      2  box
Created orthogonal box = (-16.795962 -16.795962 -16.795962) to (16.795962 16.795962 16.795962)
  1 by 1 by 1 MPI processor grid
create_atoms    1  region ball
Created 2123 atoms
  using lattice units in orthogonal box = (-16.795962 -16.795962 -16.795962) to (16.795962 16.795962 16.795962)
  create_atoms CPU = 0.001 seconds

pair_style      lj/cut 4.0
pair_coeff      * *  1.0 1.0
mass            *    1.0
set             group all mol 1
Setting atom values ...
  2123 settings made for mol

# label half the sphere with a different type for better visualization
set             region half   type 2
Setting atom values ...
  1142 settings made for type

# use a dynamic group (may require a patch to fix addtorque with older versions of LAMMPS)
group           ball   dynamic all   region ball
dynamic group ball defined

neigh_modify    delay 2  every 1  check yes

minimize        0.0  0.0    1000  10000
Switching to 'neigh_modify every 1 delay 0 check yes' setting during minimization
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.3
  ghost atom cutoff = 4.3
  binsize = 2.15, bins = 16 16 16
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.035 | 5.035 | 5.035 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -6.2285099      0             -6.2285099     -0.38871568   
      1000   0             -7.3616908      0             -7.3616908     -9.0533714e-16
Loop time of 8.65957 on 1 procs for 1000 steps with 2123 atoms

99.7% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
     -6.22850993032182  -7.36169083402272  -7.36169083402273
  Force two-norm initial, final = 197.76248 3.410242e-12
  Force max component initial, final = 7.8870448 1.5416141e-13
  Final line search alpha, max atom move = 1 1.5416141e-13
  Iterations, force evaluations = 1000 1994

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 8.5569     | 8.5569     | 8.5569     |   0.0 | 98.81
Neigh   | 0.041276   | 0.041276   | 0.041276   |   0.0 |  0.48
Comm    | 0.00047159 | 0.00047159 | 0.00047159 |   0.0 |  0.01
Output  | 2.4534e-05 | 2.4534e-05 | 2.4534e-05 |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.06094    |            |       |  0.70

Nlocal:           2123 ave        2123 max        2123 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         270799 ave      270799 max      270799 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 270799
Ave neighs/atom = 127.55488
Neighbor list builds = 11
Dangerous builds = 0
reset_timestep  0

velocity        all create 1.2 12351235

fix             1   all  nve
fix             2   all  wall/reflect  xlo EDGE xhi EDGE ylo EDGE yhi EDGE zlo EDGE zhi EDGE

compute 1 all chunk/atom molecule
compute 2 ball omega/chunk 1
compute 3 ball inertia/chunk 1

# compute rotational kinetic energy: 1/2 * I * omega**2
variable r_ke_x equal c_2[1][1]*c_2[1][1]*c_3[1][1]*0.5
variable r_ke_y equal c_2[1][2]*c_2[1][2]*c_3[1][2]*0.5
variable r_ke_z equal c_2[1][3]*c_2[1][3]*c_3[1][3]*0.5

# output moments of inertia for x,y,z and angular velocity as well as rotational kinertic energy

thermo_style custom step ke pe c_3[1][1] c_3[1][2] c_3[1][3] c_2[1][1] c_2[1][2] c_2[1][3] v_r_ke_x v_r_ke_y v_r_ke_z
thermo 500

# dump 1 all atom 100 dump.lammpstrj

# dump 2 all movie 10 ball.mp4 type mass

# equilibration w/o torque added
run 1000 post no
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 4.039 | 4.039 | 4.039 Mbytes
   Step         KinEng         PotEng       c_3[1][1]      c_3[1][2]      c_3[1][3]      c_2[1][1]      c_2[1][2]      c_2[1][3]       v_r_ke_x       v_r_ke_y       v_r_ke_z   
         0   1.7991521     -7.3616908      51125.265      51125.265      51125.265      0.0034331372  -0.0045852283   0.0091015032   0.30129221     0.53743693     2.117541     
       500   0.8882476     -6.43927        52585.112      52205.936      52112.109      0.0033058719  -0.0043753253   0.0089502237   0.2873458      0.49970143     2.0872595    
      1000   0.79407357    -6.337372       53754.145      54093.977      53787.624      0.0033214912  -0.0042125031   0.0090171557   0.29651603     0.47995375     2.1867116    
Loop time of 2.60445 on 1 procs for 1000 steps with 2123 atoms


# start spinning the ball. rotation around z should increase and Erot_z should grow
fix 4 ball addtorque/group 0.0 0.0 200.0
run 10000 upto  post no
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 4.039 | 4.039 | 4.039 Mbytes
   Step         KinEng         PotEng       c_3[1][1]      c_3[1][2]      c_3[1][3]      c_2[1][1]      c_2[1][2]      c_2[1][3]       v_r_ke_x       v_r_ke_y       v_r_ke_z   
      1000   0.79407357    -6.337372       53754.145      54093.977      53787.624      0.0033214912  -0.0042125031   0.0090171557   0.29651603     0.47995375     2.1867116    
      1500   0.68685306    -6.2226287      55026.889      54809.958      55224.858      0.0026096779  -0.0039390202   0.01797948     0.18737808     0.42521236     8.9260406    
      2000   0.6537039     -6.1832481      54914.897      55655.542      55405.782      0.0029311107  -0.0040761891   0.02581646     0.23589819     0.46236725     18.463688    
      2500   0.69376171    -6.2174341      54605.098      54800.447      54489.07       0.0028895009  -0.0045028638   0.035784813    0.22795486     0.55556098     34.888068    
      3000   0.78089134    -6.2981146      53732.207      53740.718      53874.738      0.0030209563  -0.004008851    0.044594077    0.24518481     0.43183049     53.568506    
      3500   0.81338694    -6.3212389      53318.326      52950.746      53053.392      0.003138907   -0.0047455106   0.0545094      0.26266572     0.59622198     78.8181      
      4000   0.83397829    -6.3283498      53053.603      53010.479      53255.291      0.0035794953  -0.0042577516   0.063386868    0.33988225     0.48049889     106.98708    
      4500   0.82528629    -6.3012199      53522.53       53200.237      53078.811      0.0040340631  -0.0044169394   0.072681457    0.43550387     0.51895112     140.19691    
      5000   0.78921665    -6.2464218      53957.443      53396.666      53710.927      0.0026952112  -0.0037381965   0.081738376    0.19597785     0.37308553     179.4257     
      5500   0.81717327    -6.253721       54088.138      53745.533      53769.491      0.0040686626  -0.0044377584   0.090223221    0.44768792     0.52922419     218.848      
      6000   0.83370101    -6.2480473      53797.27       53727.251      53526.541      0.0036915905  -0.0046044802   0.099125984    0.36657031     0.56954211     262.97485    
      6500   0.88076649    -6.2710639      53661.221      53714.333      53351.2        0.0016851694  -0.0044396497   0.10793809     0.076193461    0.52936791     310.78758    
      7000   0.90720039    -6.2701872      53634.282      53504.923      53080.72       0.0031514022  -0.0044732877   0.11788671     0.26633003     0.53532485     368.83869    
      7500   0.93159566    -6.2668679      53803.55       53534.167      53437.998      0.0031148592  -0.0041958085   0.12602687     0.26101037     0.47122939     424.37177    
      8000   0.98403751    -6.2880784      53395.113      53334.497      53195.184      0.0029312997  -0.0058738934   0.1357883      0.22939923     0.92009004     490.4187     
      8500   1.0042256     -6.276346       53080.844      53135.008      53120.842      0.0032525815  -0.0049133452   0.14508468     0.28077872     0.64136507     559.0853     
      9000   1.029419      -6.2657742      53098.764      53326.802      53055.073      0.0023445685  -0.0044332764   0.15402592     0.14594199     0.52404088     629.33885    
      9500   1.0358252     -6.2350991      53961.272      53491.797      53591.582      0.003774188   -0.0046323047   0.16117378     0.38432554     0.57392008     696.07396    
     10000   1.1170005     -6.2766659      53597.574      53365.444      53325.827      0.0037753833  -0.0050299981   0.17124448     0.38197702     0.67509638     781.88119    
Loop time of 25.2169 on 1 procs for 9000 steps with 2123 atoms


# continue without adding more torque. rotation continues at fixed speed
unfix 4
run 5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 4.039 | 4.039 | 4.039 Mbytes
   Step         KinEng         PotEng       c_3[1][1]      c_3[1][2]      c_3[1][3]      c_2[1][1]      c_2[1][2]      c_2[1][3]       v_r_ke_x       v_r_ke_y       v_r_ke_z   
     10000   1.1170005     -6.2766659      53597.574      53365.444      53325.827      0.0037753833  -0.0050299981   0.17124448     0.38197702     0.67509638     781.88119    
     10500   1.0789981     -6.2388451      52447.569      52528.733      54553.595      0.0035332238  -0.0038539405   0.16521222     0.32736907     0.3901009      744.52231    
     11000   1.100998      -6.2610432      52700.394      52514.217      55120.569      0.0034203308  -0.0031568304   0.16465406     0.30826207     0.26166728     747.18573    
     11500   1.0905944     -6.2503402      52789.528      52432.204      53630.814      0.0034158212  -0.0036981068   0.16805852     0.30796974     0.35853124     757.36544    
     12000   1.0854571     -6.2449457      52502.817      52644.871      54332.514      0.0036427372  -0.0026243385   0.16669567     0.34834397     0.18128662     754.88095    
     12500   1.0895906     -6.2488496      52655.576      52567.603      54792.067      0.0026315171  -0.0039359194   0.164126       0.18231683     0.40717451     737.97639    
     13000   1.0781073     -6.23742        52402.475      52785.311      54448.631      0.002207209   -0.0034999581   0.16438204     0.12764645     0.32330228     735.64065    
     13500   1.078831      -6.23846        52216.933      52138.025      54526.796      0.003388742   -0.0024555675   0.16335614     0.29981847     0.15719124     727.53005    
     14000   1.0633448     -6.2228495      52124.228      52501.276      54648.893      0.0029065161  -0.0035031699   0.16275563     0.22016847     0.32215307     723.80805    
     14500   1.0529262     -6.2119015      51936.711      51882.957      54383.504      0.0031348034  -0.0026859      0.16273563     0.25519082     0.18714336     720.11602    
     15000   1.0667579     -6.2261855      51842.323      51250.87       55087.921      0.0033077469  -0.0045355716   0.16004236     0.28360834     0.52715133     705.49885    
Loop time of 13.3359 on 1 procs for 5000 steps with 2123 atoms

Performance: 161968.900 tau/day, 374.928 timesteps/s, 795.972 katom-step/s
99.8% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 10.897     | 10.897     | 10.897     |   0.0 | 81.71
Neigh   | 2.1911     | 2.1911     | 2.1911     |   0.0 | 16.43
Comm    | 0.0042284  | 0.0042284  | 0.0042284  |   0.0 |  0.03
Output  | 0.0013069  | 0.0013069  | 0.0013069  |   0.0 |  0.01
Modify  | 0.21745    | 0.21745    | 0.21745    |   0.0 |  1.63
Other   |            | 0.02455    |            |       |  0.18

Nlocal:           2123 ave        2123 max        2123 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:         241255 ave      241255 max      241255 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 241255
Ave neighs/atom = 113.63872
Neighbor list builds = 565
Dangerous builds = 0
Total wall time: 0:00:50
