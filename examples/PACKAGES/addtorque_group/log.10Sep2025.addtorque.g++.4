LAMMPS (10 Sep 2025 - Development - patch_5May2020-24908-gd4c3ee3c41-modified)

units           lj
lattice         fcc 0.8442
Lattice spacing in x,y,z = 1.6795962 1.6795962 1.6795962
boundary        f f f

region          ball   sphere   0.0 0.0 0.0 5.0
region          box    block  -10 10 -10 10 -10 10
region          half   block  -10  0 -10 10 -10 10

# add molecule ids so we can use chunk/atom
fix             0   all property/atom mol ghost yes

create_box      2  box
Created orthogonal box = (-16.795962 -16.795962 -16.795962) to (16.795962 16.795962 16.795962)
  1 by 2 by 2 MPI processor grid
create_atoms    1  region ball
Created 2123 atoms
  using lattice units in orthogonal box = (-16.795962 -16.795962 -16.795962) to (16.795962 16.795962 16.795962)
  create_atoms CPU = 0.000 seconds

pair_style      lj/cut 4.0
pair_coeff      * *  1.0 1.0
mass            *    1.0
set             group all mol 1
Setting atom values ...
  2123 settings made for mol

# label half the sphere with a different type for better visualization
set             region half   type 2
Setting atom values ...
  1142 settings made for type

# use a dynamic group (may require a patch to fix addtorque with older versions of LAMMPS)
group           ball   dynamic all   region ball
dynamic group ball defined

neigh_modify    delay 2  every 1  check yes

minimize        0.0  0.0    1000  10000
Switching to 'neigh_modify every 1 delay 0 check yes' setting during minimization
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 4.3
  ghost atom cutoff = 4.3
  binsize = 2.15, bins = 16 16 16
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.339 | 4.348 | 4.355 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -6.2285099      0             -6.2285099     -0.38871568   
      1000   0             -7.3616908      0             -7.3616908     -9.3100194e-16
Loop time of 2.98891 on 4 procs for 1000 steps with 2123 atoms

99.2% CPU use with 4 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = max iterations
  Energy initial, next-to-last, final = 
     -6.22850993032362  -7.36169083402248  -7.36169083402248
  Force two-norm initial, final = 197.76248 3.3991762e-12
  Force max component initial, final = 7.8870448 2.2543079e-13
  Final line search alpha, max atom move = 1 2.2543079e-13
  Iterations, force evaluations = 1000 1994

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 1.8711     | 2.37       | 2.8583     |  24.9 | 79.29
Neigh   | 0.009486   | 0.013014   | 0.016196   |   2.6 |  0.44
Comm    | 0.07463    | 0.57089    | 1.0784     |  51.6 | 19.10
Output  | 3.3174e-05 | 3.4899e-05 | 3.9865e-05 |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 0.03495    |            |       |  1.17

Nlocal:         530.75 ave         536 max         526 min
Histogram: 1 0 1 0 0 0 0 1 0 1
Nghost:        1058.25 ave        1063 max        1053 min
Histogram: 1 0 0 1 0 0 0 0 1 1
Neighs:        67699.8 ave       81387 max       54648 min
Histogram: 1 0 0 1 0 0 1 0 0 1

Total # of neighbors = 270799
Ave neighs/atom = 127.55488
Neighbor list builds = 11
Dangerous builds = 0
reset_timestep  0

velocity        all create 1.2 12351235

fix             1   all  nve
fix             2   all  wall/reflect  xlo EDGE xhi EDGE ylo EDGE yhi EDGE zlo EDGE zhi EDGE

compute 1 all chunk/atom molecule
compute 2 ball omega/chunk 1
compute 3 ball inertia/chunk 1

# compute rotational kinetic energy: 1/2 * I * omega**2
variable r_ke_x equal c_2[1][1]*c_2[1][1]*c_3[1][1]*0.5
variable r_ke_y equal c_2[1][2]*c_2[1][2]*c_3[1][2]*0.5
variable r_ke_z equal c_2[1][3]*c_2[1][3]*c_3[1][3]*0.5

# output moments of inertia for x,y,z and angular velocity as well as rotational kinertic energy

thermo_style custom step ke pe c_3[1][1] c_3[1][2] c_3[1][3] c_2[1][1] c_2[1][2] c_2[1][3] v_r_ke_x v_r_ke_y v_r_ke_z
thermo 500

# dump 1 all atom 100 dump.lammpstrj

# dump 2 all movie 10 ball.mp4 type mass

# equilibration w/o torque added
run 1000 post no
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 3.348 | 3.357 | 3.362 Mbytes
   Step         KinEng         PotEng       c_3[1][1]      c_3[1][2]      c_3[1][3]      c_2[1][1]      c_2[1][2]      c_2[1][3]       v_r_ke_x       v_r_ke_y       v_r_ke_z   
         0   1.7991521     -7.3616908      51125.265      51125.265      51125.265      0.0040198435  -0.0024237256   0.0011306245   0.4130702      0.15016629     0.032677011  
       500   0.90968729    -6.4603004      52559.075      52593.598      52370.876      0.0039073429  -0.0023505431   0.0011032256   0.40121833     0.14529121     0.031870471  
      1000   0.80269935    -6.3456699      53966.859      54192.03       54298.931      0.0040875347  -0.0023098179   0.00077010445  0.45083753     0.14456425     0.016101285  
Loop time of 0.967242 on 4 procs for 1000 steps with 2123 atoms


# start spinning the ball. rotation around z should increase and Erot_z should grow
fix 4 ball addtorque/group 0.0 0.0 200.0
run 10000 upto  post no
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 3.348 | 3.357 | 3.362 Mbytes
   Step         KinEng         PotEng       c_3[1][1]      c_3[1][2]      c_3[1][3]      c_2[1][1]      c_2[1][2]      c_2[1][3]       v_r_ke_x       v_r_ke_y       v_r_ke_z   
      1000   0.80269935    -6.3456699      53966.859      54192.03       54298.931      0.0040875347  -0.0023098179   0.00077010445  0.45083753     0.14456425     0.016101285  
      1500   0.68922642    -6.2266953      54966.109      54681.607      54947.256      0.0038798952  -0.0016325789   0.0099837591   0.41371856     0.072871824    2.7384461    
      2000   0.64105072    -6.1739646      54782.996      54570.486      54910.317      0.003464545   -0.0027242816   0.01776357     0.32878213     0.20250316     8.663322     
      2500   0.6990366     -6.2284977      54307.702      53953.062      54537.74       0.0035091611  -0.0022453427   0.02826161     0.33437826     0.13600391     21.780153    
      3000   0.76738997    -6.2919991      53474.134      53633.539      53621.53       0.0034005828  -0.0013088746   0.037862459    0.30918646     0.04594122     38.434995    
      3500   0.77469281    -6.2914228      53085.203      52948.845      53090.109      0.0040365638  -0.0021894385   0.04743418     0.43248111     0.12690888     59.72641     
      4000   0.79637907    -6.3010841      53312.007      52962.409      53635.285      0.0036187855  -0.0020365178   0.056097371    0.34907659     0.10982827     84.392841    
      4500   0.79759497    -6.286311       54066.986      54002.513      54246.911      0.0037578278  -0.0021259376   0.065254104    0.38174725     0.12203516     115.49433    
      5000   0.79156688    -6.2634233      53710.867      53381.798      54221.317      0.0037722179  -0.0025690351   0.072203898    0.38214282     0.17615837     141.33879    
      5500   0.79545641    -6.2484692      53975.908      53532.013      53896.988      0.0027339993  -0.0028535551   0.081029192    0.20172827     0.21794962     176.93653    
      6000   0.8241036     -6.2574615      53597.027      53542.36       54031.181      0.002179201   -0.0021029495   0.090316432    0.12726392     0.11839277     220.36773    
      6500   0.85563869    -6.266253       53656.851      53588.996      54094.727      0.002609519   -0.0030414923   0.10000756     0.18269057     0.24786721     270.51454    
      7000   0.89365815    -6.2801773      53769.969      53346.595      54203.298      0.0030774199  -0.0024342745   0.10916962     0.2546146      0.15805776     322.99761    
      7500   0.93874056    -6.2994169      52929.132      53491.204      54177.7        0.0027995321  -0.0030768506   0.11695352     0.20741285     0.25320088     370.52467    
      8000   0.93109412    -6.2622701      53568.418      54061.929      54616.829      0.0035506106  -0.0028410194   0.12747003     0.33766412     0.21817749     443.72372    
      8500   0.97439519    -6.276562       53012.705      53150.86       54681.316      0.0032293667  -0.0037699486   0.13428535     0.27642969     0.37770363     493.02192    
      9000   0.98249722    -6.2512643      53088.283      53428.741      54347.783      0.0043576168  -0.0040380297   0.14380882     0.50404204     0.43559608     561.9826     
      9500   1.0392183     -6.2727082      53310.738      53452.308      54654.036      0.0043623147  -0.0034991792   0.15290928     0.50724607     0.32724184     638.93977    
     10000   1.0842496     -6.2813769      53915.335      53215.349      54811.914      0.0057588915  -0.0027187211   0.16143259     0.8940465      0.19666915     714.21247    
Loop time of 9.52719 on 4 procs for 9000 steps with 2123 atoms


# continue without adding more torque. rotation continues at fixed speed
unfix 4
run 5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 3.348 | 3.357 | 3.362 Mbytes
   Step         KinEng         PotEng       c_3[1][1]      c_3[1][2]      c_3[1][3]      c_2[1][1]      c_2[1][2]      c_2[1][3]       v_r_ke_x       v_r_ke_y       v_r_ke_z   
     10000   1.0842496     -6.2813769      53915.335      53215.349      54811.914      0.0057588915  -0.0027187211   0.16143259     0.8940465      0.19666915     714.21247    
     10500   1.067429      -6.2641982      52366.875      51640.877      55006.997      0.0054597409  -0.0014397021   0.15640715     0.78049609     0.053519109    672.82351    
     11000   1.0497327     -6.2462682      52175.186      51942.401      55517.269      0.0052557685  -0.0017751197   0.15507033     0.72062026     0.081836549    667.50655    
     11500   1.0433565     -6.2396779      52393.003      52470.598      55315.752      0.0044148491  -0.001028431    0.15605797     0.51059319     0.027748295    673.58242    
     12000   1.0302077     -6.2265735      51641.848      51800.424      55408.541      0.0053304152  -0.00056855032  0.1521112      0.73365833     0.0083722298   641.01633    
     12500   1.0663034     -6.2627842      51839.16       52305.476      55483.426      0.0028141808  -9.6385255e-05  0.1547477      0.20527307     0.000242962    664.32665    
     13000   1.0332381     -6.2301145      51173.45       52215.372      54838.398      0.002210762   -0.0010096809   0.15483452     0.12505431     0.026615623    657.34047    
     13500   1.0602358     -6.2569447      51180.375      51168.765      54657.737      0.0031975099  -0.00067929375  0.15361118     0.26163585     0.011805658    644.86277    
     14000   1.0298413     -6.2263933      51505.634      51754.555      55482.802      0.0010282729  -0.00093909615  0.15475507     0.027229615    0.022821212    664.38244    
     14500   1.0581584     -6.2548159      51028.127      50662.23       54917.451      0.0013368825  -0.0021223096   0.1529335      0.045600134    0.11409636     642.22266    
     15000   1.0343681     -6.2311554      51829.524      51406.855      55707.121      0.0033901214  -0.0028750471   0.15327078     0.29783637     0.21246185     654.33392    
Loop time of 5.08042 on 4 procs for 5000 steps with 2123 atoms

Performance: 425161.432 tau/day, 984.170 timesteps/s, 2.089 Matom-step/s
98.1% CPU use with 4 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2.4401     | 3.1335     | 3.8905     |  32.6 | 61.68
Neigh   | 0.45337    | 0.63872    | 0.833      |  20.6 | 12.57
Comm    | 0.2039     | 1.1623     | 2.0499     |  69.1 | 22.88
Output  | 0.00075061 | 0.00078743 | 0.00085341 |   0.0 |  0.02
Modify  | 0.11208    | 0.11694    | 0.12284    |   1.1 |  2.30
Other   |            | 0.02814    |            |       |  0.55

Nlocal:         530.75 ave         535 max         519 min
Histogram: 1 0 0 0 0 0 0 0 0 3
Nghost:        1053.75 ave        1071 max        1043 min
Histogram: 1 0 2 0 0 0 0 0 0 1
Neighs:        60596.5 ave       73114 max       49404 min
Histogram: 1 0 1 0 0 0 1 0 0 1

Total # of neighbors = 242386
Ave neighs/atom = 114.17146
Neighbor list builds = 556
Dangerous builds = 0
Total wall time: 0:00:19
