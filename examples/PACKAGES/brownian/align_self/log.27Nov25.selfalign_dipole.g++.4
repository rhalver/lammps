LAMMPS (10 Sep 2025 - Development - patch_10Sep2025-628-g2877ee4689-modified)
OMP_NUM_THREADS environment is not set. Defaulting to 1 thread.
  using 1 OpenMP thread(s) per MPI task
# -----------------------------
# Example script for self-propelled and self-aligning particles performing 2D collective motion using sphere + dipole
# -----------------------------
variable NParticles equal 10000
variable Seed equal 12345
variable BoxSize equal 200

variable Mass equal 1.0
variable ActiveForce equal 2.0
variable SelfAlignment equal 0.6
variable RelaxTime equal 0.2            # Relaxation time to terminal velocity for mass 1
variable Temperature equal 0.01

variable WCA_cut equal 1.122

# -----------------------------
# Generic Simulation parameters
# -----------------------------
units       lj
dimension   2
boundary    p p p
atom_style  hybrid sphere dipole
WARNING: Atom style hybrid defines both, per-type and per-atom masses; both must be set, but only per-atom masses will be used (src/atom_vec_hybrid.cpp:132)

# -----------------------------
# Simulation box and atoms
# -----------------------------
region       box block 0 ${BoxSize} 0 ${BoxSize} -0.5 0.5
region       box block 0 200 0 ${BoxSize} -0.5 0.5
region       box block 0 200 0 200 -0.5 0.5
create_box   2 box
Created orthogonal box = (0 0 -0.5) to (200 200 0.5)
  2 by 2 by 1 MPI processor grid
create_atoms 1 random ${NParticles} ${Seed} box
create_atoms 1 random 10000 ${Seed} box
create_atoms 1 random 10000 12345 box
Created 10000 atoms
  using lattice units in orthogonal box = (0 0 -0.5) to (200 200 0.5)
  create_atoms CPU = 0.001 seconds

# -----------------------------
# Equilibration run to remove overlaps
# -----------------------------
pair_style      soft 1.122
pair_coeff      * * 0.0
variable        prefactor equal ramp(0,100) # strength of soft potential is increase slowly over time

fix             1 all brownian 0.0001 ${Seed} gamma_t 1.0
fix             1 all brownian 0.0001 12345 gamma_t 1.0
fix             2 all adapt 1 pair soft a * * v_prefactor
thermo          1000
run             5000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 1.422
  ghost atom cutoff = 1.422
  binsize = 0.711, bins = 282 282 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair soft, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.148 | 5.149 | 5.149 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0              0              0              0              0            
      1000   0.021384428    1.1247764e-06  0              0.021383414    0.0055763658 
      2000   0.021012255    8.0487387e-07  0              0.021010959    0.0054190267 
      3000   0.0212503      5.9923016e-07  0              0.021248774    0.0054468079 
      4000   0.020982739    6.2443274e-07  0              0.020981265    0.0053718432 
      5000   0.02086962     9.1579467e-08  0              0.020867624    0.005262227  
Loop time of 0.447523 on 4 procs for 5000 steps with 10000 atoms

Performance: 4826562.892 tau/day, 11172.599 timesteps/s, 111.726 Matom-step/s
99.6% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.051286   | 0.054758   | 0.056878   |   0.9 | 12.24
Neigh   | 0.0015948  | 0.0016332  | 0.0016852  |   0.1 |  0.36
Comm    | 0.027874   | 0.029945   | 0.033784   |   1.3 |  6.69
Output  | 6.5174e-05 | 6.8651e-05 | 7.8411e-05 |   0.0 |  0.02
Modify  | 0.3179     | 0.3326     | 0.34194    |   1.6 | 74.32
Other   |            | 0.02852    |            |       |  6.37

Nlocal:           2500 ave        2569 max        2390 min
Histogram: 1 0 0 0 0 1 0 0 1 1
Nghost:            148 ave         152 max         145 min
Histogram: 1 0 1 0 1 0 0 0 0 1
Neighs:        2007.75 ave        2124 max        1840 min
Histogram: 1 0 0 0 0 1 0 0 1 1

Total # of neighbors = 8031
Ave neighs/atom = 0.8031
Neighbor list builds = 16
Dangerous builds = 0
unfix           1
unfix           2

# -----------------------------
# Mass, dipole, velocities
# -----------------------------
mass        * ${Mass}
mass        * 1
set         type * dipole/random ${Seed} 1.0    # dipole orientation
set         type * dipole/random 12345 1.0    
Setting atom values ...
  10000 settings made for dipole/random
velocity    all create 0.0 ${Seed} mom yes rot yes
velocity    all create 0.0 12345 mom yes rot yes

# -----------------------------
# Interactions (WCA)
# -----------------------------
pair_style      lj/cut ${WCA_cut}
pair_style      lj/cut 1.122
pair_coeff      * * 1 1 ${WCA_cut}  # Cutoff LJ at minima to become WCA
pair_coeff      * * 1 1 1.122  

# -----------------------------
# Individual dynamics
# -----------------------------
fix rotLangevin all langevin ${Temperature} ${Temperature} ${RelaxTime} ${Seed} omega yes
fix rotLangevin all langevin 0.01 ${Temperature} ${RelaxTime} ${Seed} omega yes
fix rotLangevin all langevin 0.01 0.01 ${RelaxTime} ${Seed} omega yes
fix rotLangevin all langevin 0.01 0.01 0.2 ${Seed} omega yes
fix rotLangevin all langevin 0.01 0.01 0.2 12345 omega yes
fix active all propel/self dipole ${ActiveForce}
fix active all propel/self dipole 2
fix align all align/self dipole -${SelfAlignment}
fix align all align/self dipole -0.6

# -----------------------------
# Integrators
# -----------------------------
fix nve_rot all nve/sphere update dipole
fix dipole2D all enforce2d # force z-components to zero every timestep

# -----------------------------
# Output
# -----------------------------
thermo      100
#dump        1 all custom 100 collective_motion_dipole.lammpstrj id type x y vx vy mux muy omegax omegay omegaz tqx tqy tqz

# -----------------------------
# Run
# -----------------------------
timestep    0.01
run         2000
Generated 0 of 1 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 1.422
  ghost atom cutoff = 1.422
  binsize = 0.711, bins = 282 282 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.148 | 5.149 | 5.149 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
      5000   0             -0.00089997679  0             -0.00089997679 -0.24569778   
      5100   0.12283189    -0.25948067     0             -0.13666106     0.027671154  
      5200   0.11182145    -0.32832779     0             -0.21651752     0.21749949   
      5300   0.10848586    -0.36728362     0             -0.25880861     0.40524859   
      5400   0.10460938    -0.39192516     0             -0.28732624     0.61903054   
      5500   0.10336646    -0.40880448     0             -0.30544835     0.82609076   
      5600   0.10222413    -0.41431727     0             -0.31210336     0.92123919   
      5700   0.10072532    -0.42466404     0             -0.32394879     1.0685288    
      5800   0.098963342   -0.43674442     0             -0.33779098     1.0747683    
      5900   0.099922592   -0.44271337     0             -0.34280077     1.1391234    
      6000   0.097606576   -0.4622735      0             -0.36467669     1.1224011    
      6100   0.096775733   -0.46452746     0             -0.36776141     1.2046847    
      6200   0.098726964   -0.47439286     0             -0.37567577     1.2900841    
      6300   0.097824367   -0.47827621     0             -0.38046162     1.4671094    
      6400   0.096004284   -0.48532954     0             -0.38933485     1.5373273    
      6500   0.094957167   -0.49405742     0             -0.39910975     1.5323061    
      6600   0.094875176   -0.50501139     0             -0.41014571     1.5441789    
      6700   0.093900896   -0.50608124     0             -0.41218974     1.6416384    
      6800   0.093781639   -0.51331773     0             -0.41954547     1.6137202    
      6900   0.092924203   -0.52516885     0             -0.43225393     1.7263156    
      7000   0.093112771   -0.52424239     0             -0.43113894     1.7974768    
Loop time of 0.535767 on 4 procs for 2000 steps with 10000 atoms

Performance: 3225280.262 tau/day, 3732.963 timesteps/s, 37.330 Matom-step/s
99.6% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.036054   | 0.037999   | 0.040416   |   0.8 |  7.09
Neigh   | 0.017121   | 0.0175     | 0.018038   |   0.3 |  3.27
Comm    | 0.013094   | 0.015805   | 0.018069   |   1.5 |  2.95
Output  | 0.00025713 | 0.0003578  | 0.00048793 |   0.0 |  0.07
Modify  | 0.42747    | 0.44281    | 0.45476    |   1.6 | 82.65
Other   |            | 0.0213     |            |       |  3.97

Nlocal:           2500 ave        2545 max        2433 min
Histogram: 1 0 0 0 1 0 0 0 0 2
Nghost:          143.5 ave         157 max         137 min
Histogram: 1 1 1 0 0 0 0 0 0 1
Neighs:           2586 ave        2750 max        2393 min
Histogram: 1 0 0 1 0 0 0 0 1 1

Total # of neighbors = 10344
Ave neighs/atom = 1.0344
Neighbor list builds = 158
Dangerous builds = 0

Total wall time: 0:00:00
